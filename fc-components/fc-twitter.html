<link rel="import" href="../dev/polymer/polymer.html">
<link rel="import" href="../dev/paper-button/paper-button.html">
<link rel="import" href="../dev/paper-input/paper-input.html">

<dom-module id="fc-twitter">

	<template>
		<h3>Twitter Feed</h3>
		<paper-input id="fcTrack" label="Twitter Search Term" on-keydown="_checkChange"></paper-input>
		<paper-button on-tap="_changeTerm">Change Twitter Term</paper-button>
		<paper-button on-tap="_stopper">Stop</paper-button>
	</template>



</dom-module>

<script>
	//
	// twitter.get('favorites/list', function(error, tweets, response) {
	// 	if (error) throw error;
	// 	console.log(tweets);
	// });

	Polymer({
		is: 'fc-twitter',
		properties: {
			searchTerm: String
		},
		_checkChange: function(e) {
			//console.log("Key hit");
			if (e.keyCode == 13) {
				this._changeTerm();
			}
		},
		attached: function() {
			var ref = this;
			ipcRenderer = require('electron').ipcRenderer;
			ipcRenderer.on('changeTerm', function(event, args) {
				//console.debug("Got something!", event, args);
				ref._add(args);
			});
		},
		_changeTerm: function() {
			//console.debug("Got change term in renderer", ipcRenderer);
			ipcRenderer.send('changeTerm', this.$.fcTrack.value);
		},
		_add: function(item) {
			var ref = this;
			//console.debug("ADD SHOUT", item.user, item.body);
			if (item.user !== undefined && item.shout !== undefined) {
				//console.debug("Making a shoutdata");
				var shoutdata = {
					user: item.user.name,
					body: item.shout,
					source: 'Twitter'
				}
			};
			//console.debug("Shoutdata input", shoutdata);
			ref.fire('add-shout', {
				//value: this.$.fcInput.value
				value: shoutdata
			});
		}
	});
</script>
